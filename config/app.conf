events {
    worker_connections  1024;
}

rtmp {
    server {
        listen 1935;
        chunk_size 4096;
        notify_method get;
        application live {
            on_publish http://localhost/auth;
            live on;
            #Set this to "record off" if you don't want to save a copy of your broadcasts
            record off;
            # The directory in which the recordings will be stored
            record_path /var/www/html/recordings;
            record_unique on;
        }
    }
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    
    server {

        listen 80;
        location /auth {
            if ($arg_pwd = 'a_secret_password') {
                return 200;
            }
            return 401;
        }
    }
}
